<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.2/cookieconsent.min.css" />
<script async defer src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.2/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#424242"
    },
    "button": {
      "background": "#2a7ae2"
    }
  },
  "content": {
    "href": "/privacy-policy"
  }
})});
</script>
  
  
  
  <title>Exploit Exercises: Nebula Level 08</title>
  <meta name="description" content="">
  
    
    <meta name="keywords" content="Lucian Nitescu nebula writeups level flag getflag exploit exercise tutorial solution">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://nitesculucian.github.io/2018/07/16/exploit-exercises-nebula-level-08/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Lucian Nitescu" href="https://nitesculucian.github.io/feed.xml">
  <meta name="flattr:id" content="njnwdo">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="Exploit Exercises: Nebula Level 08">
  <meta name="twitter:description" content="">
  
  

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet">

  
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-107695141-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Lucian Nitescu</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/">Home</a>
      
        
        <a class="page-link" href="/about/">Whoami</a>
      
        
        <a class="page-link" href="/archives/">Archives</a>
      
    </nav>
    <br>Security Blog
  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">Exploit Exercises: Nebula Level 08</h1>
    
    <p class="post-meta"><time datetime="2018-07-16T15:49:00-03:00" itemprop="datePublished">Jul 16, 2018</time> •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/nebula/">nebula</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/writeups/">writeups</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  



</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><img src="/uploads/Screenshot%20from%202018-07-16%2000-20-16.png" alt="Image of Nebula Terminal" /></p>

<p>World readable files strike again. Check what that user was up to, and use it to log into flag08 account.
To do this level, log in as the level08 account with the password level08. Files for this level can be found in /home/flag08.</p>

<h3 id="source-code">Source code</h3>

<p>There is no source code available for this level</p>

<h3 id="solution">Solution</h3>

<p>As usual let’s go to our flag account folder. I bet you will get bored of that at some point.</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">level08@nebula:~$</span> <span class="nb">cd</span> /home/flag08/
<span class="gp">level08@nebula:/home/flag08$</span> <span class="nb">ls</span> <span class="nt">-al</span>
<span class="go">total 14
drwxr-x--- 2 flag08 level08   86 Aug 19  2012 .
drwxr-xr-x 1 root   root      80 Aug 27  2012 ..
-rw-r--r-- 1 flag08 flag08   220 May 18  2011 .bash_logout
-rw-r--r-- 1 flag08 flag08  3353 May 18  2011 .bashrc
-rw-r--r-- 1 flag08 flag08   675 May 18  2011 .profile
-rw-r--r-- 1 root   root    8302 Nov 20  2011 capture.pcap
</span><span class="gp">level08@nebula:/home/flag08$</span>
</code></pre></div></div>

<p>Hmm, for the first time it seems to be a pcap file!</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">level08@nebula:/home/flag08$</span> file capture.pcap
<span class="go">capture.pcap: tcpdump capture file (little-endian) - version 2.4 (Ethernet, capture length 65535)
</span><span class="gp">level08@nebula:/home/flag08$</span>
</code></pre></div></div>

<p>Definitely! But what is wireshark or tcpdump?</p>

<p>Wireshark is a network packet analyzer. A network packet analyzer will try to capture network packets and tries to display that packet data as detailed as possible.</p>

<p>You could think of a network packet analyzer as a measuring device used to examine what’s going on inside a network cable, just like a voltmeter is used by an electrician to examine what’s going on inside an electric cable (but at a higher level, of course).</p>

<p>In the past, such tools were either very expensive, proprietary, or both. However, with the advent of Wireshark, all that has changed.</p>

<p>Wireshark is perhaps one of the best open source packet analyzers available today.</p>

<p>And in other simpler words, tcpdump is the CLI (Command Line Interface) tool as Wireshark.</p>

<p>As you can see we have to open the “capture.pcap” file in a one of the above described tools and to get some information about our task. Personally I enjoy and know Wireshark, but here I can not install anything. Let’s make a simple HTTP server using python to retrive our file from the server.</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">level08@nebula:/home/flag08$</span>  python <span class="nt">-m</span> SimpleHTTPServer
<span class="go">Serving HTTP on 0.0.0.0 port 8000 ...
</span></code></pre></div></div>

<p><img src="/uploads/Screenshot%20from%202018-07-16%2022-31-01.png" alt="Python Service" /></p>

<p><img src="/uploads/Screenshot%20from%202018-07-16%2022-31-19.png" alt="Pcap" /></p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">level08@nebula:/home/flag08$</span>  python <span class="nt">-m</span> SimpleHTTPServer
<span class="go">Serving HTTP on 0.0.0.0 port 8000 ...
192-168-0-104.myownisp.hacker - - [24/Oct/2017 12:57:43] "GET / HTTP/1.1" 200 -
192-168-0-104.myownisp.hacker - - [24/Oct/2017 12:57:43] code 404, message File not found
192-168-0-104.myownisp.hacker - - [24/Oct/2017 12:57:43] "GET /robots.txt HTTP/1.1" 404 -
192-168-0-104.myownisp.hacker - - [24/Oct/2017 12:57:43] code 404, message File not found
192-168-0-104.myownisp.hacker - - [24/Oct/2017 12:57:43] "GET /favicon.ico HTTP/1.1" 404 -
192-168-0-104.myownisp.hacker - - [24/Oct/2017 12:58:25] "GET /capture.pcap HTTP/1.1" 200 -
^CTraceback (most recent call last):
  File "/usr/lib/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
</span><span class="gp">  File "/usr/lib/python2.7/SimpleHTTPServer.py", line 220, in &lt;module&gt;</span>
<span class="go">    test()
  File "/usr/lib/python2.7/SimpleHTTPServer.py", line 216, in test
    BaseHTTPServer.test(HandlerClass, ServerClass)
  File "/usr/lib/python2.7/BaseHTTPServer.py", line 602, in test
    httpd.serve_forever()
  File "/usr/lib/python2.7/SocketServer.py", line 225, in serve_forever
    r, w, e = select.select([self], [], [], poll_interval)
KeyboardInterrupt
</span><span class="gp">level08@nebula:/home/flag08$</span>
</code></pre></div></div>

<p>At this point I closed my HTTP server. Let’s see the file I have just downloaded.</p>

<p>Right click on first packet &gt; Follow &gt; TCP Stream</p>

<p><img src="/uploads/Screenshot%20from%202018-07-16%2022-31-45.png" alt="Pcap" /></p>

<p>At this point you could try your luck with the given password, but you can be also smarter and interpret everything in hexa.</p>

<p><img src="/uploads/Screenshot%20from%202018-07-16%2022-32-05.png" alt="Pcap" /></p>

<p>In other words:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
   <span class="mo">00000000</span>  <span class="n">ff</span> <span class="n">fd</span> <span class="mi">25</span>                                           <span class="o">..%</span>
<span class="mo">00000000</span>  <span class="n">ff</span> <span class="n">fc</span> <span class="mi">25</span>                                           <span class="o">..%</span>
    <span class="mo">00000003</span>  <span class="n">ff</span> <span class="n">fb</span> <span class="mi">26</span> <span class="n">ff</span> <span class="n">fd</span> <span class="mi">18</span> <span class="n">ff</span> <span class="n">fd</span>  <span class="mi">20</span> <span class="n">ff</span> <span class="n">fd</span> <span class="mi">23</span> <span class="n">ff</span> <span class="n">fd</span> <span class="mi">27</span> <span class="n">ff</span>   <span class="o">..&amp;.....</span>  <span class="o">..</span><span class="c">#..'.</span>
    <span class="mo">00000013</span>  <span class="n">fd</span> <span class="mi">24</span>                                              <span class="o">.</span><span class="err">$</span>
<span class="mo">00000003</span>  <span class="n">ff</span> <span class="n">fe</span> <span class="mi">26</span> <span class="n">ff</span> <span class="n">fb</span> <span class="mi">18</span> <span class="n">ff</span> <span class="n">fb</span>  <span class="mi">20</span> <span class="n">ff</span> <span class="n">fb</span> <span class="mi">23</span> <span class="n">ff</span> <span class="n">fb</span> <span class="mi">27</span> <span class="n">ff</span>   <span class="o">..&amp;.....</span>  <span class="o">..</span><span class="c">#..'.</span>
<span class="mo">00000013</span>  <span class="n">fc</span> <span class="mi">24</span>                                              <span class="o">.</span><span class="err">$</span>
    <span class="mo">00000015</span>  <span class="n">ff</span> <span class="n">fa</span> <span class="mi">20</span> <span class="mo">01</span> <span class="n">ff</span> <span class="n">f0</span> <span class="n">ff</span> <span class="n">fa</span>  <span class="mi">23</span> <span class="mo">01</span> <span class="n">ff</span> <span class="n">f0</span> <span class="n">ff</span> <span class="n">fa</span> <span class="mi">27</span> <span class="mo">01</span>   <span class="o">..</span> <span class="o">.....</span> <span class="c">#.....'.</span>
    <span class="mo">00000025</span>  <span class="n">ff</span> <span class="n">f0</span> <span class="n">ff</span> <span class="n">fa</span> <span class="mi">18</span> <span class="mo">01</span> <span class="n">ff</span> <span class="n">f0</span>                            <span class="o">........</span>
<span class="mo">00000015</span>  <span class="n">ff</span> <span class="n">fa</span> <span class="mi">20</span> <span class="mo">00</span> <span class="mi">33</span> <span class="mi">38</span> <span class="mi">34</span> <span class="mi">30</span>  <span class="mi">30</span> <span class="mi">2</span><span class="n">c</span> <span class="mi">33</span> <span class="mi">38</span> <span class="mi">34</span> <span class="mi">30</span> <span class="mi">30</span> <span class="n">ff</span>   <span class="o">..</span> <span class="o">.</span><span class="mi">3840</span> <span class="mi">0</span><span class="p">,</span><span class="mf">38400.</span>
<span class="mo">00000025</span>  <span class="n">f0</span> <span class="n">ff</span> <span class="n">fa</span> <span class="mi">23</span> <span class="mo">00</span> <span class="mi">53</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">64</span>  <span class="mi">61</span> <span class="mi">43</span> <span class="mi">61</span> <span class="mi">6</span><span class="n">e</span> <span class="mi">3</span><span class="n">a</span> <span class="mi">30</span> <span class="n">ff</span> <span class="n">f0</span>   <span class="o">...</span><span class="c">#.Sod aCan:0..</span>
<span class="mo">00000035</span>  <span class="n">ff</span> <span class="n">fa</span> <span class="mi">27</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mi">44</span> <span class="mi">49</span> <span class="mi">53</span>  <span class="mi">50</span> <span class="mi">4</span><span class="n">c</span> <span class="mi">41</span> <span class="mi">59</span> <span class="mo">01</span> <span class="mi">53</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">64</span>   <span class="o">..</span><span class="s">'..DIS PLAY.Sod</span><span class="err">
</span><span class="s">00000045  61 43 61 6e 3a 30 ff f0  ff fa 18 00 78 74 65 72   aCan:0.. ....xter</span><span class="err">
</span><span class="s">00000055  6d ff f0                                           m..</span><span class="err">
</span><span class="s">    0000002D  ff fb 03 ff fd 01 ff fd  22 ff fd 1f ff fb 05 ff   ........ ".......</span><span class="err">
</span><span class="s">    0000003D  fd 21                                              .!</span><span class="err">
</span><span class="s">00000058  ff fd 03 ff fc 01 ff fb  22 ff fa 22 03 01 00 00   ........ ".."....</span><span class="err">
</span><span class="s">00000068  03 62 03 04 02 0f 05 00  00 07 62 1c 08 02 04 09   .b...... ..b.....</span><span class="err">
</span><span class="s">00000078  42 1a 0a 02 7f 0b 02 15  0f 02 11 10 02 13 11 02   B....... ........</span><span class="err">
</span><span class="s">00000088  ff ff 12 02 ff ff ff f0  ff fb 1f ff fa 1f 00 b1   ........ ........</span><span class="err">
</span><span class="s">00000098  00 31 ff f0 ff fd 05 ff  fb 21                     .1...... .!</span><span class="err">
</span><span class="s">    0000003F  ff fa 22 01 03 ff f0                               .."....</span><span class="err">
</span><span class="s">000000A2  ff fa 22 01 07 ff f0                               .."....</span><span class="err">
</span><span class="s">    00000046  ff fa 21 03 ff f0 ff fb  01 ff fd 00 ff fe 22      ..!..... ......"</span><span class="err">
</span><span class="s">000000A9  ff fd 01 ff fb 00 ff fc  22                        ........ "</span><span class="err">
</span><span class="s">    00000055  ff fa 22 03 03 e2 03 04  82 0f 07 e2 1c 08 82 04   .."..... ........</span><span class="err">
</span><span class="s">    00000065  09 c2 1a 0a 82 7f 0b 82  15 0f 82 11 10 82 13 11   ........ ........</span><span class="err">
</span><span class="s">    00000075  82 ff ff 12 82 ff ff ff  f0                        ........ .</span><span class="err">
</span><span class="s">    0000007E  0d 0a 4c 69 6e 75 78 20  32 2e 36 2e 33 38 2d 38   ..Linux  2.6.38-8</span><span class="err">
</span><span class="s">    0000008E  2d 67 65 6e 65 72 69 63  2d 70 61 65 20 28 3a 3a   -generic -pae (::</span><span class="err">
</span><span class="s">    0000009E  66 66 66 66 3a 31 30 2e  31 2e 31 2e 32 29 20 28   ffff:10. 1.1.2) (</span><span class="err">
</span><span class="s">    000000AE  70 74 73 2f 31 30 29 0d  0a 0a 01 00 77 77 77 62   pts/10). ....wwwb</span><span class="err">
</span><span class="s">    000000BE  75 67 73 20 6c 6f 67 69  6e 3a 20                  ugs logi n:</span><span class="err">
</span><span class="s">000000B2  6c                                                 l</span><span class="err">
</span><span class="s">    000000C9  00 6c                                              .l</span><span class="err">
</span><span class="s">000000B3  65                                                 e</span><span class="err">
</span><span class="s">    000000CB  00 65                                              .e</span><span class="err">
</span><span class="s">000000B4  76                                                 v</span><span class="err">
</span><span class="s">    000000CD  00 76                                              .v</span><span class="err">
</span><span class="s">000000B5  65                                                 e</span><span class="err">
</span><span class="s">    000000CF  00 65                                              .e</span><span class="err">
</span><span class="s">000000B6  6c                                                 l</span><span class="err">
</span><span class="s">    000000D1  00 6c                                              .l</span><span class="err">
</span><span class="s">000000B7  38                                                 8</span><span class="err">
</span><span class="s">    000000D3  00 38                                              .8</span><span class="err">
</span><span class="s">000000B8  0d                                                 .</span><span class="err">
</span><span class="s">    000000D5  01                                                 .</span><span class="err">
</span><span class="s">    000000D6  00 0d 0a 50 61 73 73 77  6f 72 64 3a 20            ...Passw ord:</span><span class="err">
</span><span class="s">000000B9  62                                                 b</span><span class="err">
</span><span class="s">000000BA  61                                                 a</span><span class="err">
</span><span class="s">000000BB  63                                                 c</span><span class="err">
</span><span class="s">000000BC  6b                                                 k</span><span class="err">
</span><span class="s">000000BD  64                                                 d</span><span class="err">
</span><span class="s">000000BE  6f                                                 o</span><span class="err">
</span><span class="s">000000BF  6f                                                 o</span><span class="err">
</span><span class="s">000000C0  72                                                 r</span><span class="err">
</span><span class="s">000000C1  7f                                                 .</span><span class="err">
</span><span class="s">000000C2  7f                                                 .</span><span class="err">
</span><span class="s">000000C3  7f                                                 .</span><span class="err">
</span><span class="s">000000C4  30                                                 0</span><span class="err">
</span><span class="s">000000C5  30                                                 0</span><span class="err">
</span><span class="s">000000C6  52                                                 R</span><span class="err">
</span><span class="s">000000C7  6d                                                 m</span><span class="err">
</span><span class="s">000000C8  38                                                 8</span><span class="err">
</span><span class="s">000000C9  7f                                                 .</span><span class="err">
</span><span class="s">000000CA  61                                                 a</span><span class="err">
</span><span class="s">000000CB  74                                                 t</span><span class="err">
</span><span class="s">000000CC  65                                                 e</span><span class="err">
</span><span class="s">000000CD  0d                                                 .</span><span class="err">
</span><span class="s">    000000E3  00 0d 0a                                           ...</span><span class="err">
</span><span class="s">    000000E6  01                                                 .</span><span class="err">
</span><span class="s">    000000E7  00 0d 0a 4c 6f 67 69 6e  20 69 6e 63 6f 72 72 65   ...Login  incorre</span><span class="err">
</span><span class="s">    000000F7  63 74 0d 0a 77 77 77 62  75 67 73 20 6c 6f 67 69   ct..wwwb ugs logi</span><span class="err">
</span><span class="s">    00000107  6e 3a 20                                           n:</span><span class="err">

</span></code></pre></div></div>

<p>Here you can observe that the “dots” are actually 0x7f in hexa which means “Backspace” in ASCII. So instead of “backdoor…​00Rm8.ate” as password we have “backd00Rmate”. For the grand final:</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">level08@nebula:/home/flag08$</span> <span class="nb">id</span>
<span class="go">uid=1009(level08) gid=1009(level08) groups=1009(level08)
</span><span class="gp">level08@nebula:/home/flag08$</span> su flag08
<span class="go">Password:
</span><span class="gp">sh-4.2$</span> <span class="nb">id</span>
<span class="go">uid=991(flag08) gid=991(flag08) groups=991(flag08)
</span><span class="gp">sh-4.2$</span> getflag
<span class="go">You have successfully executed getflag on a target account
</span><span class="gp">sh-4.2$</span>
</code></pre></div></div>

<p>See you in the next tutorial.</p>

<h3 id="sources">Sources</h3>
<p>https://www.wireshark.org/docs/wsug_html_chunked/ChapterIntroduction.html</p>

  </div>

  
    <div class="post-comments" itemprop="comment">
      <hr />
<h1>Comments</h1>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://nitesculucian.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
  

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy; Lucian Nitescu - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://nitesculucian.github.io/feed.xml">RSS</a>

      | <a href="/privacy-policy" >Privacy Policy</a>
      | <a href="/legal-disclaimer" >Legal Disclaimer</a>
    </p>

  </div>

</footer>


  </body>

</html>
