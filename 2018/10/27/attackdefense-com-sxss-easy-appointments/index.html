<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.2/cookieconsent.min.css" />
<script async defer src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.2/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#424242"
    },
    "button": {
      "background": "#2a7ae2"
    }
  },
  "content": {
    "href": "/privacy-policy"
  }
})});
</script>
  
  
  
  <title>AttackDefense.com [SXSS] - Easy Appointments</title>
  <meta name="description" content="">
  
    
    <meta name="keywords" content="Lucian Nitescu DCTF DefCamp 2018 competition CTF capture flag chall challange">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://nitesculucian.github.io/2018/10/27/attackdefense-com-sxss-easy-appointments/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Lucian Nitescu" href="https://nitesculucian.github.io/feed.xml">
  <meta name="flattr:id" content="njnwdo">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="AttackDefense.com [SXSS] - Easy Appointments">
  <meta name="twitter:description" content="">
  
  

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet">

  
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-107695141-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Lucian Nitescu</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/">Home</a>
      
        
        <a class="page-link" href="/about/">Whoami</a>
      
        
        <a class="page-link" href="/archives/">Archives</a>
      
    </nav>
    <br>Security Blog
  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">AttackDefense.com [SXSS] - Easy Appointments</h1>
    
    <p class="post-meta"><time datetime="2018-10-27T16:40:00-03:00" itemprop="datePublished">Oct 27, 2018</time> •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/attackdefense-com/">AttackDefense.com</a>,
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/ctf/">ctf</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/writeups/">writeups</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/storedxss/">StoredXSS</a>
      
    
  



</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><img src="/uploads/Screenshot from 2018-10-26 17-44-27.png" alt="Image of AttackDefense 2018" /></p>

<h3 id="mission">Mission</h3>

<p>A version of Easy Appointments is vulnerable to stored cross site scripting attack. This application is vulnerable to multiple reflected and stored XSS vulnerabilities. Your task is to find and exploit them.</p>

<p>The following username and password may be used to explore the application and create regular users if required to exploit authenticated access vulnerabilities:</p>

<ul>
  <li>User: admin</li>
  <li>Password: password</li>
</ul>

<p>Level difficulty: Easy</p>

<p>Category: Real World Webapps &gt; Stored XSS</p>

<h3 id="solution">Solution</h3>

<p>At first,  I was prompted straight to the application “Backed Section” at <a href="http://75dux4a6duu9d9ikl8elrdxsc.public1.attackdefenselabs.com/easyappointments/index.php/user/login">http://75dux4a6duu9d9ikl8elrdxsc.public1.attackdefenselabs.com/easyappointments/index.php/user/login</a>.</p>

<p><img src="/uploads/Screenshot from 2018-10-27 22-45-53.png" alt="Image of AttackDefense 2018" /></p>

<p>By trimming the given URL of the application, I found the following valid path:</p>

<ul>
  <li><a href="http://75dux4a6duu9d9ikl8elrdxsc.public1.attackdefenselabs.com/easyappointments/index.php">http://75dux4a6duu9d9ikl8elrdxsc.public1.attackdefenselabs.com/easyappointments/index.php</a></li>
</ul>

<p><img src="/uploads/Screenshot from 2018-10-27 22-49-43.png" alt="Image of AttackDefense 2018" /></p>

<p>I discovered, by filling the public available form, that on step 3 it is the best place to inject my JavaScript payloads in order to achieve a Stored XSS Exploit.</p>

<p><img src="/uploads/Screenshot from 2018-10-27 23-00-05.png" alt="Image of AttackDefense 2018" /></p>

<p>After that, I received an appointment confirmation with a safe and escaped (at least for the user) output of my payloads.</p>

<p><img src="/uploads/Screenshot from 2018-10-27 23-03-01.png" alt="Image of AttackDefense 2018" /></p>

<p>Here my payloads are already saved in the database of the application with no error (SQL Injection Vulnerabilities, restricted format or characters).</p>

<p><img src="/uploads/Screenshot from 2018-10-27 23-04-16.png" alt="Image of AttackDefense 2018" /></p>

<p>Using the provided credentials on <a href="http://75dux4a6duu9d9ikl8elrdxsc.public1.attackdefenselabs.com/easyappointments/index.php/user/login">http://75dux4a6duu9d9ikl8elrdxsc.public1.attackdefenselabs.com/easyappointments/index.php/user/login</a> page we obtain access to the admin interface where you can observe the followings:</p>

<p><img src="/uploads/Screenshot from 2018-10-27 23-10-55.png" alt="Image of AttackDefense 2018" /></p>

<p>By clicking on the 29 October 2018 appointment (my appointment), we will execute two different payloads that can be linked back to our inputs.</p>

<p><img src="/uploads/Screenshot from 2018-10-27 23-14-05.png" alt="Image of AttackDefense 2018" /></p>

<p><img src="/uploads/Screenshot from 2018-10-27 23-14-12.png" alt="Image of AttackDefense 2018" /></p>

<p><img src="/uploads/Screenshot from 2018-10-27 23-14-21.png" alt="Image of AttackDefense 2018" /></p>

<p>With the above example and not just in this scenario, an attacker can compromise the session of the admin user in order to obtain access to the application backend.</p>

<p><img src="/uploads/Screenshot from 2018-10-27 23-19-06.png" alt="Image of AttackDefense 2018" /></p>

  </div>

  
    <div class="post-comments" itemprop="comment">
      <hr />
<h1>Comments</h1>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://nitesculucian.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
  

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy; Lucian Nitescu - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://nitesculucian.github.io/feed.xml">RSS</a>

      | <a href="/privacy-policy" >Privacy Policy</a>
      | <a href="/legal-disclaimer" >Legal Disclaimer</a>
    </p>

  </div>

</footer>


  </body>

</html>
